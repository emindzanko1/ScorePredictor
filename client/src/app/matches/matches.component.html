<form (ngSubmit)="submitPredictions()" #predictionForm="ngForm">
    @for (round of schedule; track $index) {
    <div class="container">
        <h3>{{ round.round }}</h3>
        <table class="schedule">
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Home</th>
                <th></th>
                <th>Away</th>
                <th>Outcome</th>
                <th>Result</th>
                <th>Scorer</th>
            </tr>
            @for (match of round.matches; track $index) {
            <tr>
                <td>{{ match.date }}</td>
                <td>{{ match.time }}</td>
                <td>{{ match.home }}</td>
                <td>-</td>
                <td>{{ match.away }}</td>
                <td>
                    <select [(ngModel)]="prediction.outcomes[$index]" name="outcome-{{ match.home }}-{{ match.away }}"
                        required>
                        <option value="1">1</option>
                        <option value="X">X</option>
                        <option value="2">2</option>
                    </select>
                </td>
                <td>
                    <input [(ngModel)]="prediction.result" 
                    name="result-{{ match.home }}-{{ match.away }}"
                    placeholder="Result" 
                    (focus)="selectResultNew($index)" 
                    (blur)="clearResult()" 
                    (input)="updateResult($event, $index)"
                    [attr.disabled]="selectedResultIndex !== $index ? true : null"
                    required />
                </td>
                <td>
                    <select class="player-select" [(ngModel)]="prediction.scorer"
                        name="scorer-{{ match.home }}-{{ match.away }}" (change)="selectScorer(match)" required>
                        @for (player of getPlayersByClubs(match.home, match.away); track $index) {
                        <option [value]="player.name">
                            {{ player.name }}
                        </option>
                        }
                    </select>
                </td>
            </tr>
            }
        </table>
        <br>
        <button type="submit" class="submit-btn" [disabled]="!validatePredictions()">Submit Predictions</button>
    </div>
    }
</form>